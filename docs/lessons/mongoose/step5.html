<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Post Request w/ Mongoose</title>
        <link rel="stylesheet" href="styles.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-jsx.min.js"></script>
    </head>
    <body>
        <div
            class="slide-container"
            role="region"
            aria-labelledby="lesson-header">
            <header class="slide-header">
                <h1 id="lesson-header">Post Request w/ Mongoose</h1>
                <h2>Lesson</h2>
            </header>

            <div class="section">
                <iframe
                    class="video-embed"
                    width="1698"
                    height="713"
                    src="https://www.youtube.com/embed/XE8I6UOfTBU"
                    title="Post request with Mongoose"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin"
                    allowfullscreen></iframe>
            </div>

            <hr class="section-divider" />

            <div class="section">
                <h3>Learning Objectives</h3>
                <p>
                    A student will be able to write an express route that adds a
                    new document to the database.
                </p>
            </div>

            <hr class="section-divider" />

            <div class="section">
                <h3>Why are POST Requests Important?</h3>
                <p>
                    POST requests are a fundamental concept in web development.
                    They allow clients (like web browsers) to send data to a
                    server to create or update resources. This is essential for
                    various functionalities, including:
                </p>
                <ul class="custom-list">
                    <li>User registration and login</li>
                    <li>Creating new blog posts or articles</li>
                    <li>
                        Submitting forms with data (e.g., contact forms,
                        surveys)
                    </li>
                    <li>Uploading files</li>
                </ul>
                <p>
                    Understanding POST requests empowers you to build dynamic
                    web applications that interact with data.
                </p>
            </div>

            <hr class="section-divider" />

            <div class="section">
                <h3>Code Breakdown:</h3>
                <pre><code class="language-jsx">
movieRouter.post('/', async (req, res, next) => {
try {
// 1. Extract movie data from request body
const newMovie = new Movie(req.body);
// 2. Save the new movie document
const savedMovie = await newMovie.save();

// 3. Handle successful save (status 201)
return res.status(201).send(savedMovie);
} catch (error) {
// 4. Handle errors (status 500)
res.status(500);
return next(error);
}
});
            </code></pre>
            </div>

            <hr class="section-divider" />

            <div class="section">
                <h3>Explanation:</h3>
                <ol class="custom-list">
                    <li>
                        <strong
                            ><code
                                >movieRouter.post('/', async (req, res, next) =>
                                { ... })</code
                            >:</strong
                        >
                        <p>
                            This line defines a route handler for the POST HTTP
                            method on the root path (<code>/</code>) of the
                            <code>movieRouter</code>.
                        </p>
                        <p>The asynchronous function takes three arguments:</p>
                        <ul class="custom-list">
                            <li>
                                <code>req</code>: The incoming request object
                                containing data from the client (typically in
                                the request body).
                            </li>
                            <li>
                                <code>res</code>: The response object used to
                                send data back to the client.
                            </li>
                            <li>
                                <code>next</code>: A function for passing errors
                                to middleware.
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong
                            ><code>const newMovie = new Movie(req.body);</code
                            >:</strong
                        >
                        <p>
                            This line creates a new movie document instance
                            using the <code>Mongoose</code>
                            <code>Movie</code> model.
                        </p>
                        <p>
                            It extracts the movie data from the request body
                            (<code>req.body</code>) and uses it to construct the
                            new document.
                        </p>
                        <p>
                            The assumption here is that the request body
                            contains the necessary properties (fields) that
                            match the structure of your <code>Movie</code> model
                            schema.
                        </p>
                    </li>
                    <li>
                        <strong
                            ><code
                                >const savedMovie = await newMovie.save();</code
                            >:</strong
                        >
                        <p>
                            This line attempts to save the newly created
                            <code>newMovie</code> document to the database.
                        </p>
                        <p>
                            The <code>save</code> method is asynchronous, so we
                            use <code>await</code> to wait for the operation to
                            complete before proceeding.
                        </p>
                        <p>
                            Upon successful save, the
                            <code>savedMovie</code> variable will hold the saved
                            document with its generated ID and other properties.
                        </p>
                    </li>
                    <li>
                        <strong
                            ><code
                                >return res.status(201).send(savedMovie);</code
                            >:</strong
                        >
                        <p>This block handles the successful save scenario:</p>
                        <ul class="custom-list">
                            <li>
                                <code>res.status(201)</code> sets the response
                                status code to 201 (Created). This indicates
                                that a new resource (movie) was created.
                            </li>
                            <li>
                                <code>res.send</code> sends the newly created
                                and saved movie document
                                (<code>savedMovie</code>) back to the client as
                                a response. This allows the client to see the
                                complete information about the created resource.
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong><code>catch (error) { ... }</code>:</strong>
                        <p>
                            This block handles any errors that might occur
                            during the movie creation and saving process.
                        </p>
                        <ul class="custom-list">
                            <li>
                                <code>res.status(500)</code> sets the response
                                status code to 500 (Internal Server Error) if an
                                error occurs.
                            </li>
                            <li>
                                <code>return next(error)</code> passes the error
                                object to the next middleware in the chain for
                                further handling (e.g., logging).
                            </li>
                        </ul>
                    </li>
                </ol>
            </div>

            <hr class="section-divider" />

            <div class="section">
                <h3>Additional Notes:</h3>
                <p>Additional Notes:</p>
                <ul class="custom-list">
                    <li>
                        Ensure your <code>Movie</code> model schema is properly
                        defined to match the expected data structure from the
                        client.
                    </li>
                    <li>
                        Consider implementing validation logic on the
                        server-side to ensure the received data is valid before
                        saving it to the database. This can help prevent
                        potential issues with invalid data.
                    </li>
                    <li>
                        Error handling is crucial for a robust application.
                        Always implement proper error handling mechanisms to
                        provide informative responses to the client in case of
                        issues.
                    </li>
                </ul>
            </div>

            <footer class="slide-footer"></footer>
        </div>
        <!-- Post Request w/ Mongoose -->
        <script
            src="https://vschool-reports.netlify.app/ltp.js"
            data-api="https://vschool-reports.netlify.app"
            data-lesson-id="L5-MONGOOSE-006"
            data-lesson-title="Post Request w/ Mongoose"
            data-course-id="Web Development"></script>
        <script
            src="https://vschool-reports.netlify.app/feedback.js"
            data-api="https://vschool-reports.netlify.app"
            data-lesson-id="L5-MONGOOSE-006"
            data-lesson-title="Post Request w/ Mongoose"
            data-course-id="Web Development"
            data-button-selector="#myFeedbackBtn"></script>
    </body>
</html>
